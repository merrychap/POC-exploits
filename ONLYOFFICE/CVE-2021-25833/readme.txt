[ Description ]
A file extension handling issue was found in [server] module of ONLYOFFICE
DocumentServer v4.2.0.71-v5.6.0.21. The file extension is controlled by an attacker
through the request data and leads to arbitrary file overwriting. Using this
vulnerability, a remote attacker can obtain remote code execution on DocumentServer. 

[Vulnerability Type]
File Handling Issues (CWE-23)

[Affected Code Base]
DocumentServer: https://github.com/ONLYOFFICE/DocumentServer
affected versions: v4.0.0-9 - v5.6.0; fixed version: v5.6.1

server: https://github.com/ONLYOFFICE/server
affected versions: v4.2.0.71 - v5.6.0.21; fixed version 5.6.1.1

[Affected Component]
Affected module: https://github.com/ONLYOFFICE/server/tree/v5.6.0.21
Affected functions:
  convertservice.js:convertRequest(req, res, isJson),
  converter.js:ExecuteTask(task),
  converter.js:downloadFile(docId, uri, fileFrom, withAuthorization)
Affected executable: server

[Attack Type]
Remote

[Impact]
Code Execution
Denial of Service

[Attack Vectors]
To exploit this vulnerability, an attacker must send the crafted request 
for file conversion. If the URL is specified inside of the request, then
the server will download an external file into the local filesystem. 
Server misses validations on the file extension (specified inside of the
request as well) and saves the external file data into the local file 
path with appended extension to the end of the file path. The file 
extension is controlled by an attacker through the request data and 
leads to arbitrary file overwriting. This primitive leads to remote code
execution on remote DocumentServer by overwriting x2t binary 
(responsible for format conversion) and then sending a new request 
triggering the payload already written into x2t binary (reverse shell 
for example)
