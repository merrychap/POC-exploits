[ Description ]
An improper binary stream data handling issue was found in the [core]
module of ONLYOFFICE DocumentServer v4.0.0-9-v5.6.3. Using this bug, an
attacker is able to produce a denial of service attack that can eventually
shut down the target server. 

[Vulnerability Type]
Incorrect binary stream data handling (CWE-835)

[Affected Code Base]
DocumentServer: https://github.com/ONLYOFFICE/DocumentServer
affected versions: v4.0.0-9 - v5.6.3; fixed version: v5.6.4

core: https://github.com/ONLYOFFICE/core
affected versions: v4.2.0.236 - v5.6.4.10; fixed version: v5.6.4.16

[Affected Component]
Affected module: https://github.com/ONLYOFFICE/core/tree/v5.6.4.10
Affected functions:
  PPTX::Theme::fromPPTY,
  CBinaryFileReader::GetUChar,
  CBinaryFileReader::GetChar,
  CBinaryFileReader::GetUChar_TypeNode,
  CBinaryFileReader::GetULon
Affected executable: x2t

[Attack Type]
Remote

[Impact]
Code Execution
Denial of Service

[Attack Vectors]
To exploit this vulnerability an attacker must send a request to convert
a crafted file from DOCT into DOCX format. In order to convert file 
format, a binary stream reader is created. The bug is located inside of
the incorrect upper bound stream handling in the file attribute processing
that leads to an infinitive loop with dynamic memory allocations. Eventually,
it leads to both Denial of Service at the service level and memory 
exhaustion at the server level. DocumentServer uses message queues in 
order to process client requests, for every conversion request a new thread
with x2t process is created. The request processing ends with either 
timeout or x2t process termination. Timeout is large enough to exhaust 
RAM memory at the server, hence an attacker might send requests in 
parallel to consume every possible thread at the message queue.
